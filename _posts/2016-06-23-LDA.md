---
layout: post
title: LDA 简介
date: 2016-06-23
categories: blog
tags: [Machine Learning,LDA]
description: LDA
---



# LDA 简介

我们来学习一下LDA（Latent Dirichlet Allocation）模型。

## 前言

按照wiki上的介绍，LDA由Blei, David M.、Ng, Andrew Y.、Jordan于2003年提出，是一种[主题模型](https://zh.wikipedia.org/wiki/主题模型)，它可以将文档集 中每篇文档的主题以概率分布的形式给出，从而通过分析一些文档抽取出它们的主题（分布）出来后，便可以根据主题（分布）进行主题聚类或文本分类。同时，它是一种典型的词袋模型，即一篇文档是由一组词构成，词与词之间没有先后顺序的关系。

一篇文档可以包含多个主题，文档中每一个词都由其中的一个主题生成。当人们需要生成一段文档的时候，首先确定假定这一段文档所包含的topic，而每一个topic都有包含的词汇。如下图所示，包含四个话题。
![model](http://img.blog.csdn.net/20141117153816148)

生成文档时，以一定的概率选取上述某个主题，再以一定的概率选取那个主题下的某个单词，不断的重复这两步，最终生成如下图所示的一篇文章

![test](http://img.blog.csdn.net/20141117154035285)

反之，在训练阶段，我们需要反推这一个过程，推断这一段文章是由什么主题组成的。假定们可能会认为作者先确定这篇文章的几个主题，然后围绕这几个主题遣词造句，表达成文。
    
LDA就是要干这事：根据给定的一篇文档，推测其主题分布。通过此模型生成的文档方式如下：

1.从狄利克雷分布$\alpha$中取样生成文档 i 的主题分布$\theta_i$

2.从主题的多项式分布$\theta_i$中取样生成文档i第 j 个词的主题$z_{ij}$

3.从狄利克雷分布$\beta$中取样生成主题对应的词语分布$\phi_{z_{ij}}$

4.从词语的多项式分布中采样最终生成词语$w_{ij}$



![dict](http://img.blog.csdn.net/20141117152903751)


#### 二项分布（Binomial distribution）

二项分布是从伯努利分布推进的。伯努利分布，又称两点分布或0-1分布，是一个离散型的随机分布，其中的随机变量只有两类取值，非正即负{+，-}。而二项分布即重复n次的伯努利。简言之，只做一次实验，是伯努利分布，重复做了n次，是二项分布。二项分布的概率密度函数为

![bi](http://img.blog.csdn.net/20141117234739906)


#### 多项分布（Multinomial Distribution）

多项分布是指单次试验中的随机变量的取值不再是0-1的，而是有多种离散值可（1,2,3...,k）。比如投掷6个面的骰子实验，N次实验结果服从K=6的多项分布。其中

![pro](http://img.blog.csdn.net/20141117235427677)

多项分布的概率密度函数为：

![mulit](http://img.blog.csdn.net/20141117235452512)


#### Beta 分布（Beta distribution）

给定参数$\alpha$和$\beta$，取值为[0,1]的随机变量x的概率密度函数为

![beta](http://img.blog.csdn.net/20141117235056953)

其中

![gamma](http://img.blog.csdn.net/20141117235115532),![gamma](http://img.blog.csdn.net/20141117235123035)

注意其中的Gamma函数。

#### Dirichlet 分布（Dirichlet distribution）是beta分布在高维度上的推广

![Dir](http://img.blog.csdn.net/20141117235506350)

其中

![dir1](http://img.blog.csdn.net/20141117235524695)

#### Gamma 函数与 Beta 分布

**问题1**

给定$x_1, x_2, x_n.....$为均匀[0,1]分布的随机变量，将这n的变量随机排序后，$x_k$的分布为？

![gamma](http://img.blog.csdn.net/20141117174509835)


取定$\alpha=k$和$\beta = n-k+1$

![fromgamama](http://img.blog.csdn.net/20141117180513843)


### Beta分布

以上已经介绍过Beta分布的基本数学公式以及概率含义，为了理解 Beta 分布和 二项分布的共轭关系，我们重新回到上面一个问题


**问题2**

给定$x_1, x_2, x_n.....$为均匀[0,1]分布的随机变量，将这n的变量随机排序后，$ p = X_k$

给定$y_1, y_2, y_n.....$为均匀[0,1]分布的随机变量, Y 中有 m1 比 P 小， m2 比 p 大， 

求问p对Y的条件概率？？？

![pY](http://img.blog.csdn.net/20141117183714937)

**先验分布** + **样本信息** = **后验分布**

我们知道，这一问题的先验分布为Beta分布，样本信息为[0,1]二项分布

类比以上问题，我们可以得到以下等式

![x1](http://img.blog.csdn.net/20141117185216670)

更一般的关系为


![con](http://img.blog.csdn.net/20141117185325671)

由此，我们可以得到 **针对于这种观测到的数据符合二项分布，参数的先验分布和后验分布都是Beta分布的情况**，**就是Beta-Binomial共轭**。换言之，Beta分布是二项式分布的共轭先验概率分布

### 共轭先验概率分布


**在贝叶斯概率理论中，如果后验概率和先验概率满足同样的分布律，那么，先验分布和后验分布被叫做共轭分布，同时，先验分布叫做似然函数的共轭先验分布**


举个例子。投掷一个非均匀硬币，可以使用参数为θ的伯努利模型，θ为硬币为正面的概率，那么结果x的分布形式为：

![re](http://img.blog.csdn.net/20141117224140453)


其共轭先验为beta分布，具有两个参数$\alpha$和$\beta$，称为超参数（hyperparameters）。且这两个参数决定了θ参数，其Beta分布形式为

![re](http://img.blog.csdn.net/20141117230028113)

然后计算后验概率为

![re](http://img.blog.csdn.net/20141117230441640)







